.TH QCCWAVSUBBANDPYRAMID 3 "QCCPACK" ""
.SH NAME
QccWAVSubbandPyramid \- data structure
for a two-dimensional dyadic subband decomposition of an image
.SH SYNOPSIS
.B #include "libQccPack.h"
.sp
.BI "int QccWAVSubbandPyramidInitialize(QccWAVSubbandPyramid *" subband_pyramid );
.br
.BI "int QccWAVSubbandPyramidAlloc(QccWAVSubbandPyramid *" subband_pyramid );
.br
.BI "void QccWAVSubbandPyramidFree(QccWAVSubbandPyramid *" subband_pyramid );
.br
.BI "int QccWAVSubbandPyramidNumLevelsToNumSubbands(int " num_levels );
.br
.BI "int QccWAVSubbandPyramidNumSubbandsToNumLevels(int " num_subbands );
.br
.BI "int QccWAVSubbandPyramidCalcLevelFromSubband(int " subband ", int " num_levels );
.br
.BI "int QccWAVSubbandPyramidSubbandSize(const QccWAVSubbandPyramid *" subband_pyramid ", int " subband ", int *" subband_num_rows ", int *" subband_num_cols );
.br
.BI "int QccWAVSubbandPyramidSubbandOffsets(const QccWAVSubbandPyramid *" subband_pyramid ", int " subband ", int *" row_offset ", int *" col_offset );
.br
.BI "void QccWAVSubbandPyramidSubbandToQccString(int " subband ", int " num_levels ", QccString " qccstring );
.br
.BI "int QccWAVSubbandPyramidPrint(const QccWAVSubbandPyramid *" subband_pyramid );
.SH DESCRIPTION
QccPack provides data structure
.B QccWAVSubbandPyramid
for representing two-dimensional subband decompositions of
images.
This subband-pyramid structure can be read from and written to 
.BR SBP -format
files, or a
.B QccWAVSubbandPyramid
structure can be used without file input or output.
.LP
The main component of a
.B QccWAVSubbandPyramid
structure is a matrix; this will be an
array of wavelet coefficients and will usually be arranged in
"dyadic" or "octave" decompositions (subbands) of several levels.
These dyadic subbands are nested in the upper-left corner
of the matrix.  The size of the subbands
decreases by a factor of two with each increase in level of
decomposition;  the frequency content of the subbands decreases
with increasing subband level.
.LP
Below is a diagram illustrating the composition of the subband-pyramid
matrix.  Here "B" indicates the baseband subband, while "H", "V", and "D"
indicate, respectively, vertical-, horizontal-, and diagonal-coefficient
subbands.  The level, or scale, of the subband
is the number trailing the letter; e.g., "H2" indicates
the horizontal subband on the second level of decomposition. The diagram
below shows a two-level (two-scale) decomposition.
.RS
.nf

    ------------------------------
    |      |      |              |
    |  B2  |  V2  |              |
    |      |      |              |
    ---------------      V1      |
    |      |      |              |
    |  H2  |  D2  |              |
    |      |      |              |
    ------------------------------
    |             |              |
    |             |              |
    |             |              |
    |     H1      |      D1      |
    |             |              |
    |             |              |
    |             |              |
    ------------------------------
.fi
.RE
.LP
Often, a particular subband in the subband pyramid will be addressed with an
integer subband number.  The subband number ranges from 0 (the baseband) to
.I L
* 3, where
.I L
is the number of levels of decomposition in the subband pyramid (the
.I num_levels
field in the data structure described below).
The order of the subband number is baseband, then horizontal, vertical, and
diagonal subbands in order
at the highest level, followed by the horizontal, vertical,
and diagonal subbands at the next highest level, etc.  For example, for the
two-level subband pyramid illustrated above, the following diagram shows
the corresponding subband numbers.
.RS
.nf

    ------------------------------
    |      |      |              |
    |   0  |   2  |              |
    |      |      |              |
    ---------------       5      |
    |      |      |              |
    |   1  |   3  |              |
    |      |      |              |
    ------------------------------
    |             |              |
    |             |              |
    |             |              |
    |      4      |       6      |
    |             |              |
    |             |              |
    |             |              |
    ------------------------------
.fi
.RE
.SH "DATA STRUCTURE"
The
.B QccWAVSubbandPyramid
data structure is defined as:
.RS
.nf

typedef struct
{
  QccString filename;
  QccString magic_num;
  int major_version;
  int minor_version;
  int num_levels;
  int num_rows;
  int num_cols;
  int origin_row;
  int origin_col;
  int subsample_pattern_row;
  int subsample_pattern_col;
  QccMatrix matrix;
} QccWAVSubbandPyramid;
.fi
.RE
.LP
The fields of
.B QccWAVSubbandPyramid
are as follows:
.TP
.I filename
The name of the file.
.TP
.IR magic_num ", " major_version ", " minor_version
The magic number and version of the file.
.TP
.IR num_levels
The number of levels to the subband pyramid; i.e., the
number of levels (scales) of decomposition.
.TP
.IR num_rows ", " num_cols
The overall size of the matrix of coefficients.
.TP
.IR origin_row ", " origin_col
Indicates the row and column indices of the upper-left corner of the matrix of
coefficients.
.TP
.IR subsample_pattern_row ", " subsample_pattern_col
Indicates the subsampling decomposition pattern along the rows and
columns.
.TP
.I matrix
The matrix of coefficients.
.SH "FILE FORMAT"
For reading and writing structures
of type
.BR QccWAVSubbandPyramid ,
QccPack provides the
.B SBP
file format.
This file format starts with an ASCII header followed by
binary data.
The ASCII header consists of magic-number/revision
information
followed by any amount of white space
(space, `\\t' (tab), `\\n' (newline), `\\r' (carriage return)) and/or
comments lines (lines starting with `#').  Following this white space,
additional ASCII
header information is given, separated by blanks and newlines.
Binary data follows this ASCII header information.
Note:  one (and only one) newline 
.B must
immediately follow the last component of ASCII header information before the
start of the binary data.
.LP
The
.B SBP
file format consists of the following information:
.RS
.sp
.BI SBP X.X
.br
.I "<white space>"
.br
.I L
.br
.I "C R"
.br
.IR "i11 i12" \|.\|.\|.
.br
.IR "i21 i22" \|.\|.\|.
.br
\|.
.br
\|.
.br
\|.
.br
.sp
.RE
where
.B SBP
is the magic number,
.I X.X
is the version number,
.I "<white space>"
is white space and/or 
comment lines, 
.I L
is the number of levels of nested decomposition
in the subband pyramid,
.I C
is the number of columns of the subband-pyramid image,
and
.I R
is the number of rows, 
.I imn
is the coefficient for the 
.IR m th
row, 
.IR n th
column of the subband-pyramid image.
.IR L ", " C ", and " R 
are stored in ASCII.  The image itself,
.IR imn ,
is stored as binary floating-point numbers (4 bytes each, MSB first,
see
.BR QccFileWriteDouble (3)).
The value of 
.I L
gives the number of nested (dyadic) decompositions in the 
matrix of coefficients.
If 
.I L
= 0, the image has not been decomposed; if 
.I L
>= 1,
then the 
.I L 
dyadic decompositions are recursively nested in the
upper-left corner of the coefficient matrix.
.SH "ROUTINES"
.B QccWAVSubbandPyramidInitialize()
should be called before any use of a
.B QccWAVSubbandPyramid
structure.
.B QccWAVSubbandPyramidInitialize()
initializes the fields of
.I subband_pyramid
to the following values:
.RS

.IR filename :
.B NULL
string
.br
.IR magic_num :
.B QCCSUBBANDPYRAMID_MAGICNUM
.br
.IR major_version ", " minor_version :
initialized to output of 
.BR QccGetQccPackVersion (3)
.br
.IR num_levels :
0
.br
.IR num_rows :
0
.br
.IR num_cols :
0
.br
.IR origin_row
0
.br
.IR origin_col
0
.br
.IR subsample_pattern_row :
0
.br
.IR subsample_pattern_col :
0
.br
.IR matrix :
.B NULL
.RE
.LP
.B QccWAVSubbandPyramidAlloc()
allocates storage space for 
.IR subband_pyramid->matrix .
If 
.I subband_pyramid->matrix
is not
.BR NULL ,
.B QccWAVSubbandPyramidAlloc()
returns immediately without changing the state of any memory allocation.
Otherwise,
the 
.I subband_pyramid->matrix
array is allocated.
The fields
.IR subband_pyramid->num_rows 
and
.IR subband_pyramid->num_cols 
must be set prior to calling
.BR QccWAVSubbandPyramidAlloc() .
.LP
.B QccWAVSubbandPyramidFree()
frees the
.I subband_pyramid->matrix
array previously allocated by
.BR QccWAVSubbandPyramidAlloc() .
.LP
.B QccWAVSubbandPyramidNumLevelsToNumSubbands()
calculates the number of subbands in a dyadic subband pyramid with
.I num_levels 
levels. This value is 
.I num_levels
* 3 + 1.
.LP
.B QccWAVSubbandPyramidNumSubbandsToNumLevels()
calculates the number of levels in a dyadic subband pyramid with
.I num_subbands 
subbands.
.LP
.B QccWAVSubbandPyramidCalcLevelFromSubband()
calculates the level of the specified
.I subband
in a subband pyramid with
.I num_levels
levels.
Here,
.I subband
gives the subband number of the subband in the pyramid (see diagrams above).
.LP
.B QccWAVSubbandPyramidSubbandSize()
calculates the size of the specified
.I subband
in 
.IR subband_pyramid .
The size of the subband is returned in
.I subband_num_rows
and
.IR subband_num_cols ,
which must be allocated prior to calling
.BR QccWAVSubbandPyramidSubbandSize() .
.LP
.B QccWAVSubbandPyramidSubbandOffsets()
calculates the location in
.I subband_pyramid->matrix
of the specified
.IR subband .
The row and column offsets (relative to the upper-left corner of
.IR subband_pyramid->matrix )
are returned in
.I row_offset
and
.IR col_offset ,
respectively,
which must be allocated prior to calling
.BR QccWAVSubbandPyramidSubbandOffsets() .
.LP
.B QccWAVSubbandPyramidSubbandToQccString()
converts the specified
.I subband
number into a descriptive string giving the type of subband
(horizontal, vertical, diagonal, or baseband) and the
level at which the subband resides in the subband pyramid, in a manner
exemplified by the diagrams above.
The string is returned in
.IR qccstring ,
which must be allocated prior to calling
.BR QccWAVSubbandPyramidSubbandToQccString() .
.LP
.B QccWAVSubbandPyramidPrint()
prints the contents of
.I subband_pyramid
to stdout.
.SH "RETURN VALUE"
These routines return 0 on success, and 1 on failure.
.SH "SEE ALSO"
.BR QccWAVSubbandPyramidDWT (3),
.BR QccWAVSubbandPyramidInverseDWT (3),
.BR QccPackWAV (3),
.BR QccPack (3)
.LP
M. Antonini, M. Barlaud, P. Mathieu, and I. Daubechies,
"Image Coding Using Wavelet Transform,"
.IR "IEEE Transactions on Image Processing" ,
vol. 1, pp. 205-220, April 1992.
.SH AUTHOR
Copyright (C) 1997-2016  James E. Fowler
.\"  The programs herein are free software; you can redistribute them an.or
.\"  modify them under the terms of the GNU General Public License
.\"  as published by the Free Software Foundation; either version 2
.\"  of the License, or (at your option) any later version.
.\"  
.\"  These programs are distributed in the hope that they will be useful,
.\"  but WITHOUT ANY WARRANTY; without even the implied warranty of
.\"  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\"  GNU General Public License for more details.
.\"  
.\"  You should have received a copy of the GNU General Public License
.\"  along with these programs; if not, write to the Free Software
.\"  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

