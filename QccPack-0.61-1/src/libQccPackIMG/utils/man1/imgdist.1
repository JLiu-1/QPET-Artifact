.TH IMGDIST 1 "QCCPACK" ""
.SH NAME
imgdist \- calculate the distortion between two images
.SH SYNOPSIS
.B imgdist
.RB "[\|" \-vo "\|]"
.RB "[\|" \-mse "\|]"
.RB "[\|" \-snr "\|]"
.RB "[\|" \-psnr "\|]"
.RB "[\|" \-mae "\|]"
.RB "[\|" \-cie "\|]"
.RB "[\|" \-m
.IR  mask "\|]"
.I imgfile1
.I imgfile2
.SH OPTIONS
.TP
.B \-vo
Output only the value of the distortion (terse output).
.TP
.B \-mse
Express the distortion in terms of MSE.
.TP
.B \-snr
Express the distortion in terms of SNR.
.TP
.B \-psnr
Express the distortion in terms of PSNR.
.TP
.B \-mae
Express the distortion in terms of MAE.
.TP
.B \-cie
Express the distortion in terms of an SNR based
on the 1964 CIE color distortion measure
in the CIE Modified UCS color space.  Requires that
.I imgfile1
and
.I imgfile2
be color images.
.TP
.BI \-m " mask"
String. Name of file containing the transparency mask for
shape-adaptive distortion.
.SH DESCRIPTION
.LP
.B imgdist
prints
the mean square error (MSE), signal-to-noise ratio (SNR),
peak signal-to-noise ratio (PSNR),
maximum absolute error (MAE),
or CIE-based color SNR 
between two image files,
.I imgfile1
and
.IR imgfile2 ,
to stdout.
.LP
The options
.BR \-mse ,
.BR \-snr ,
.BR \-psnr ,
.BR \-mae ,
and
.B \-cie
indicate in which form the distortion should be expressed.
If none of these
options are specified, 
.B imgdist
prints the distortion in all forms.
.LP
If the option
.B \-vo
is specified,
then 
.B imgdist
prints a terse output, consisting of only the value of the distortion,
to stdout.  One of the options
.BR \-mse ,
.BR \-snr ,
.BR \-psnr ,
.BR \-mae ,
or
.B \-cie
must be specified in this case.
.LP
For the calculation of SNR and PSNR,
.B imgfile1
is considered to be the original signal; 
.B imgdist
thus finds the variance of
.B imgfile1
for use in the SNR calculation.
For the calculation of PSNR,
.B imgdist
assumes that the peak-to-peak range of
.B imgfile1
is 255.
.LP
If the image files are color,
the MSE, SNR, PSNR, and MAE
distortion calculations are performed separately for the Y, U, and V 
components of the image.  The distortions for each image component are
output in order.
Additionally, for color images, a color SNR distortion based on
the 1964 CIE formula for the distance between two colors
is calculated
(see
.BR QccIMGImageColorSNR (3)).
.LP
The distortion calculation can be made "shape-adaptive"
by specification of the
.B \-m 
option, in which case
.I mask
gives the name of an image file that indicates the
transparency mask for the image.
.I mask
must be a grayscale image
in which black indicates transparency, white
indicates full opacity, and gray tones are degrees of
translucence
(see
.BR QccAlpha (3)).
This transparency mask indicates which regions in
.I imgfile1
and 
.I imgfile2
are to be taken into consideration in the distortion calculation---pixels
that are marked as transparent by
.I mask
are ignored and are not included in either the
calculation of pixel differences or in the total count of pixels as used
in the averaging of the differences.
.I mask
must be the same size as both
.I imgfile1
and
.IR imgfile2 .
Note: The CIE-based color SNR distortion cannot be calculated when a mask
is specified.
.SH "NOTES"
Jain defines the SNR in terms of the
log of the ratio of the signal variance to the MSE. However, Clarke
indicates that, historically, the SNR has not been defined consistently,
and describes slightly different variants, including the
variance-based definition used by Jain, as well as the log of the ratio of
the mean squared signal to the MSE, a definition popular with some
other authors. Clarke cautions that one must be sure of the definition
of the measure when comparing SNRs
as the various definitions yield different values.
.B imgdist
follows Jain's definition of a variance-based SNR.
.LP
Similarly, there are inconsistent definitions of the PSNR. The most logical
definition involves the log of the square of the actual peak-to-peak range
of the reference image to the MSE; this is the definition used by Jain.
However, the PSNR is now nearly universally accepted as the log of the
square of the
.I maximum possible
peak-to-peak range allowed by the pixels,
a value that depends on the bit-depth of the image pixels and not
the reference image itself. For example, an
8-bit image has a possible peak-to-peak range of 255, although the
actual range of any given image may be less than this.
.B imgdist
calculates PSNR using a peak-to-peak range of 255.
.SH "SEE ALSO"
.BR QccIMGImageComponentMSE (3),
.BR QccIMGImageComponentMAE (3),
.BR QccIMGImageComponentShapeAdaptiveMSE (3),
.BR QccIMGImageComponentShapeAdaptiveMAE (3),
.BR QccIMGImageColorSNR (3),
.BR QccPackIMG (3),
.BR QccPack (3)

Anil K. Jain, "Fundamentals of Digital Image Processing."
Englewood Cliffs, NJ: Prentice Hall, 1989.  (See Chapter 3).

Roger J. Clarke, "Digital Compression of Still Images and Video."
London: Academic Press Ltd., 1995.  (see Section 1.2.7).

.SH AUTHOR
Copyright (C) 1997-2016  James E. Fowler
.\"  The programs herein are free software; you can redistribute them and/or
.\"  modify them under the terms of the GNU General Public License
.\"  as published by the Free Software Foundation; either version 2
.\"  of the License, or (at your option) any later version.
.\"  
.\"  These programs are distributed in the hope that they will be useful,
.\"  but WITHOUT ANY WARRANTY; without even the implied warranty of
.\"  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\"  GNU General Public License for more details.
.\"  
.\"  You should have received a copy of the GNU General Public License
.\"  along with these programs; if not, write to the Free Software
.\"  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
